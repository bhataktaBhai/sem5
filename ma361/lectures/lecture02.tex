\section{Probability spaces} \label{sec:prob}
\lecture{2024-08-06}{Probability measures and their existence}
\begin{definition*}[probability space] \label{def:prob}
    A \emph{probability space} is a triple $(\Omega, \F, \P)$,
    where $\Omega$ is a non-empty set called the \emph{sample space},
    $\F$ is a $\sigma$-algebra on $\Omega$, and
    $\P$ is a \emph{probability measure} on $\F$.

    A \emph{probability measure} on a $\sigma$-algebra $\F$ is a function
    $\P\colon \F \to [0, 1]$ such that $\P(\Omega) = 1$ and \[
        \P\ab(\bigsqcup_n A_n) = \sum_n \P(A_n)
    \] for any sequence of pairwise disjoint sets $A_n \in \F$
    (countable additivity).
\end{definition*}
Countable additivity is a stronger condition than finite additivity.
\begin{exercise*} \label{thm:additivity}
    Prove that countable additivity is equivalent to the following two
    conditions taken together:
    \begin{enumerate}
        \item \textbf{finite additivity:} if $A \cap B = \O$, then
            $\P(A \sqcup B) = \P(A) + \P(B)$
        \item If $A_n \uparrow A$, then $\P(A_n) \uparrow \P(A)$.
    \end{enumerate}
\end{exercise*}
\begin{solution}
    Identical to \cref{thm:needs-and-desires}.
\end{solution}

\subsection*{Where do $\Omega$, $\F$, and $\P$ come from?}
$\Omega$ is simply the set of all possible outcomes.

\subsection{The $\sigma$-algebra}
$\F = 2^\Omega$ and $\F = \set{\O, \Omega}$ are bullshit choices.
In reality, $\F$ is always chosen to be the smallest $\sigma$-algebra
containing some specified sets of interest.
That is, for some $\mcS \subseteq 2^\Omega$, $\F = \sigma(\mcS)$.

This is sometimes called the $\sigma$-algebra ``generated by'' \mcS.
However, this can create a misconception.
Recall the similar notion of the \emph{span} of a set of vectors.
We can define the span of a set $S \subseteq V$ of vectors in two ways:
\begin{itemize}
    \item (external) the smallest subspace containing $S$.
    \item (internal) the set of all linear combinations of vectors in $S$.
\end{itemize}
For $\sigma(\mcS)$, there is no ``internal'' definition.
$\sigma(\mcS)$ cannot be generated by unions, intersections, etc. of sets in
\mcS.

A frequent choice for $\mcS$ is the following.
\begin{definition*}[Borel $\sigma$-algebra] \label{def:borel}
    Let $(X, d)$ be a metric space.
    The \emph{Borel $\sigma$-algebra} on $X$ is the smallest
    $\sigma$-algebra containing all open sets in $X$, and is denoted
    $\B(X)$.
\end{definition*}
\begin{exercise}[self] \label{thm:borel-R}
    Show that $\sigma\sset{(a, b)}{a, b \in \R} = \B(\R)$.
\end{exercise}
\begin{solution}
    Let $\Sigma = \sigma\sset{(a, b)}{a, b \in \R}$.
    It is obvious that $\Sigma \subseteq \B(\R)$, since the set of
    intervals is a subset of the set of all open sets.

    We will show that each open set can be written as a countable union
    of open intervals.
    Then $\sset{U \subseteq \R}{U \text{ is open}}$ would be
    necessarily contained in $\Sigma$ by \labelcref{def:sigma:u},
    and so $\B(\R) \subseteq \Sigma$.

    Let $U \in \R$ be open.
    For each $x \in U$, there exists a bounded open interval
    $I_x = (a_x, b_x) \subseteq U$ containing $x$.
    Let $(\alpha_n)_{n \in \N}$ be an enumeration of the rationals,
    and define \[
        I_n = \bigcup_{I_x \ni \alpha_n} I_x.
    \] Observe that $I_n = (\inf a_x, \sup b_x)$,
    where the inf and sup are taken over $I_x \ni \alpha_n$.

    But each $I_x$ contains a rational number,
    so $U = \bigcup_n I_n$ is a countable union of open intervals.
\end{solution}
\crefifdef{prb:borel-R}{Homework 1, problem 8} presents a neater argument.

\subsection{The probability measure}
There is some collection $\mcS \subseteq \Omega$ for which we know what
the probabilities ``should'' be, $\P\colon \mcS \to [0, 1]$.

\begin{question}
    Does $\P$ extend to a probability measure on
    $\sigma(\mcS)$? If so, is it unique?
\end{question}

Uniqueness does not hold.
\begin{example}
    Let $\Omega = \set{1, 2, 3, 4}$ and
    $\mcS = \set{\set{1, 2}, \set{2, 3}, \set{3, 4}}$.
    $\F = \sigma(\mcS) = 2^\Omega$.

    Then the probability measures given by \begin{align*}
        \underline{p} &= (.25, .25, .25, .25) \\
        \underline{q} &= (.5, 0, .5, 0)
    \end{align*} agree on $\mcS$ but differ on $\F$.
\end{example}

When does uniqueness hold?
\subsubsection{Uniqueness}
\begin{definition*}[$\pi$-system] \label{def:pi}
    A collection $\mcS \subseteq 2^\Omega$ is a \emph{$\pi$-system}
    if it is closed under finite intersections.
    That is, for any $A, B \in \mcS$, $A \cap B \in \mcS$.
\end{definition*}
\begin{definition*}[$\lambda$-system] \label{def:lambda}
    A collection $\mcC \subseteq 2^\Omega$ is a \emph{$\lambda$-system}
    if it contains $\Omega$ and is closed under
    \begin{itemize}
        \item proper differences: if $A, B \in \mcC$ and $B \subseteq A$,
            then $A \setminus B \in \mcC$.
        \item increasing limits: if $A_n \in \mcC$ and $A_n \uparrow A$,
            then $A \in \mcC$.
    \end{itemize}
\end{definition*}

\begin{theorem} \label{thm:unique}
    If $\F = \sigma(\mcS)$ where $\mcS$ is a $\pi$-system and
    $P, Q$ are probability measures on $\F$ that agree on $\mcS$,
    then $P = Q$.
\end{theorem}
\begin{proof}
    Consider $\mcG = \sset{A \in \F}{P(A) = Q(A)}$.
    Then $\mcG \supseteq \mcS$.
    Further, if $A \in \mcG$, then $A^c \in \mcG$
    since $P(A^c) = 1 - P(A) = 1 - Q(A) = Q(A^c)$.

    If $A, B \in \mcG$ are disjoint, then \[
        P(A \sqcup B) = P(A) + P(B) = Q(A) + Q(B) = Q(A \sqcup B).
    \] But how do we deal with $A, B$ not disjoint?
    We would need to show that $A, B \in \mcG \implies A \cap B \in \mcG$.

    \textbf{Resolution:} Show that $\mcG$ is a $\lambda$-system,
    and then apply the \nameref{thm:pi-lambda}.
    Suppose $A, B \in \mcG$ with $B \subseteq A$.
    Then $P(A \setminus B) = P(A) - P(B) = Q(A) - Q(B) = Q(A \setminus B)$.
    Thus $\mcG$ is closed under proper differences.

    If $A_n \uparrow A$ are in $\mcG$, then $P(A_n) \uparrow P(A)$ and
    $Q(A_n) \uparrow Q(A)$.
    But $P(A_n) = Q(A_n)$ for all $n$, so $P(A) = Q(A)$.
    Thus $\mcG$ is closed under increasing limits.

    $\mcG$ contains $\Omega$ since $P(\Omega) = Q(\Omega) = 1$.

    Thus by the $\pi$-$\lambda$ theorem, $\mcG \supseteq \F$.
\end{proof}

\begin{theorem*}[$\pi$-$\lambda$ theorem]
\label{thm:pi-lambda}
    Let $S$ be a $\pi$-system and $\mcC$ be a $\lambda$-system.
    If $\mcC \supseteq S$, then $\mcC \supseteq \sigma(S)$.
\end{theorem*}
This is due to Sierpiński and Dynkin.
\begin{proof}
    It suffices to show that $\sigma(S) = \lambda(S)$.
    Call this simply $\lambda$.
    $\lambda \supseteq S$ already contains $\Omega$, and is closed under
    complements and increasing limits by virtue of being a $\lambda$-system.
    All that's required is closure under finite unions.
    Manju shows closure under finite intersections, which is slightly
    easier.
    I will show closure under finite unions.

    For any $A \in S$, let
    $\Lambda_A = \sset{B \in \lambda}{A \cup B \in \lambda}$.
    \begin{itemize}
        \item Clearly $\Omega \in \Lambda_A$.
        \item If $B_n \upto B$ are from $\Lambda_A$, then
        $A \cup B_n \upto A \cup B$,
        so $A \cup B \in \lambda$ and hence $B \in \Lambda_A$.
        \item If $B \in \Lambda_A$, then $A \cup B \in \lambda$,
        so $B \setminus A = (A \cup B) \setminus A \in \lambda$.
        Then \[
            \Omega \setminus (B \setminus A) = \Omega \cap (B \cap A^c)^c
            = B^c \cup A \in \lambda,
        \] so $B^c \in \Lambda_A$.
        \item Let $B \in S$. \TODO[HOW?]
    \end{itemize}
    Thus $\Lambda_A$ is a $\lambda$-system containing $S$.
    This proves that $\Lambda_A = \lambda$.
    In particular, $\lambda$ is closed under union with elements of $S$.

    Now let $A \in \lambda$ and define $\Lambda_A$ as before.
    By the above, $S \subseteq \Lambda_A$.
    Now again
    \begin{itemize}
        \item $\Omega \in \Lambda_A$.
        \item If $B_n \upto B$ are from $\Lambda_A$, then
        $A \cup B_n \upto A \cup B$,
        so $A \cup B \in \lambda$ and hence $B \in \Lambda_A$.
        \item If $B \in \Lambda_A$, then $A \cup B \in \lambda$,
        so $B \setminus A = (A \cup B) \setminus A \in \lambda$.
        Then \[
            \Omega \setminus (B \setminus A) = \Omega \cap (B \cap A^c)^c
            = B^c \cup A \in \lambda,
        \] so $B^c \in \Lambda_A$.
    \end{itemize}
    Thus $\Lambda_A = \lambda$.
    That is, $\lambda$ is closed under union with elements of $\lambda$.
\end{proof}

What about existence?
\subsubsection{Existence}
In the general case, obviously not.
Consider $\Omega = [0, 1]$ with
\begin{gather*}
    \mcS = \set{(0, \frac12), (0, \frac14), (\frac14, \frac12)} \\
    \P(a, b) = (b - a)^2.
\end{gather*} Then the sum of $\P(0, \frac14)$ and $\P(\frac14, \frac12)$ is
less that $\P(0, \frac12)$.

Let us impose some necessary conditions.
\begin{definition*}[algebra] \label{def:algebra}
    A collection $\mcA \subseteq 2^\Omega$ is an \emph{algebra} if it
    $\O \in \mcA$ and it is closed under complements and finite unions.
\end{definition*}
\begin{definition*}[monotone class] \label{def:monotone-class}
    A collection $\mcM \subseteq 2^\Omega$ is a \emph{monotone class} if it
    is closed under increasing and decreasing limits.
\end{definition*}

\begin{proposition}[monotone algebra theorem] \label{thm:monotone-algebra}
    Let $\mcA$ be an algebra and $\mcM$ be a monotone class.
    If $\mcM \supseteq \mcA$, then $\mcM \supseteq \sigma(\mcA)$.
\end{proposition}
This is very similar to the \nameref{thm:pi-lambda}.
\begin{proof}
    It again suffices to show that $\sigma(\mcA) = \mcM(\mcA)$.
    Call this simply $\mcM$.
    $\mcM \supseteq \mcA$ already contains $\O$ and is closed under
    increasing and decreasing limits.
    It remains to show closure under complements and finite unions.

    Let $\mcG = \sset{A \in \mcM}{A^c \in \mcM}$.
    Since $\mcA$ is closed under complements, $\mcA \subseteq \mcG$.
    Now if $A_n \upto A$ (resp. $A_n \downto A$) are from $\mcG$,
    then $A \in \mcM$.
    Moreover, $A_n^c \downto A^c$ (resp. $A_n^c \upto A^c$) are in $\mcG$,
    so $A^c \in \mcM$.
    Thus $A \in \mcG$.
    This shows that $\mcG \subseteq \mcM$ is a monotone class containing
    $\mcA$, so $\mcG = \mcM$.
    Thus $\mcM$ is closed under complements.

    Now let $A \in \mcA$ and set
    $\mcM_A = \sset{B \in \mcM}{A \cup B \in \mcM}$.
    Again $\mcA \subseteq \mcM_A$.
    If $B_n \upto B$ (resp. $B_n \downto B$) are from $\mcM_A$,
    then $A \cup B_n \upto A \cup B$ (resp. $A \cup B_n \downto A \cup B$).
    So $A \cup B \in \mcM$ and hence $B \in \mcM_A$.
    Thus $\mcM_A \subseteq \mcM$ is a monotone class containing $\mcA$, so
    $\mcM_A = \mcM$.
    This shows that $\mcM$ is closed under union with elements of $\mcA$.

    Now let $A \in \mcM$ and define $\mcM_A$ as before.
    By the above, $\mcA \subseteq \mcM_A$.
    Closure under limits is the same as before.
    Thus $\mcM$ is closed under finite unions.
\end{proof}

\begin{table}
    \centering
    \begin{tblr}{ccccccccc}
        \hline[1pt]
        & $\O$, $\Omega$ & $A^c$ &
            $\bigcap\limits_{i=1}^n$ & $\bigcup\limits_{i=1}^n$ &
            $\bigcap\limits_{i=1}^\infty$ & $\bigcup\limits_{i=1}^\infty$ &
            {$A \setminus B$ \\ ($B \subseteq A$)} & {$A_n \upto A$} \\
        \hline[0.5pt]
        $\pi$-system    &      &      & \Yes  &      &      &      &     &    
        \\
        $\lambda$-system & \Yes & \Yes &     &     &      &      & \Yes  & \Yes
        \\
        algebra       & \Yes & \Yes & \Yes & \Yes &      &      & \Yes &    
        \\
        $\sigma$-algebra & \Yes & \Yes & \Yes & \Yes & \Yes & \Yes & \Yes & \Yes
        \\
        \hline[1pt]
    \end{tblr}
    \caption{Various systems of sets}
    \label{tab:systems}
\end{table}

\begin{figure}
    \centering
    \begin{tikzpicture}[scale=0.8]
        \node[draw, circle] (sigma) at (0, 0) {$\sigma$};
        \node[draw, circle, below left=of sigma] (algebra) {$\mcA$};
        \node[draw, circle, below right=of sigma] (lambda) {$\lambda$};
        \node[draw, circle, below=of algebra] (pi) {$\pi$};
        \path[<-]
            (pi) edge (algebra)
            (algebra) edge (sigma)
            (lambda) edge (sigma);
    \end{tikzpicture}
    \caption{Heirarchy of systems of sets under inclusion}
    \label{fig:systems}
\end{figure}

\begin{theorem*}[Carathéodory's extension theorem] \label{thm:caratheodory}
    Let $\mcS$ be an algebra.
    Assume that $P\colon \mcS \to [0, 1]$ is countably additive.
    Then there exists an extension of $P$ to a probability measure
    $\P$ on $\F = \sigma(\mcS)$.
\end{theorem*}

\begin{corollary*}
    The above extension is unique.
\end{corollary*}
\begin{proof}
    An algebra is a $\pi$-system.
    \Cref{thm:unique} applies.
\end{proof}

\section{Existence of Lebesgue measure} \label{sec:lebesgue}
\begin{theorem*} \label{thm:lebesgue}
    There is a unique probability measure $\lambda$ on
    $[0, 1]$ with the Borel $\sigma$-algebra such that \[
        \lambda[a, b] = b - a \qquad \forall\; 0 \le a \le b \le 1.
    \]
\end{theorem*}
\begin{proof}
    Let $\Omega = [0, 1)$.

    Let $\mcS_0 = \sset{[a, b)}{0 \le a \le b \le 1}$.
    Half-open intervals are nice because they are closed under complements
    $[a, b)^c = [0, a) \sqcup [b, 1)$ and intersections
    $[a, b) \cap [c, d) = [a \vee c, b \wedge d)$.

    Let \[
        \mcS = \set{I_1 \sqcup \cdots \sqcup I_k
                \mid k \ge 1, I_j \in \mcS_0 \text{ disjoint}}
    \] be the collection of all finite disjoint unions of
    half-open intervals.
    It is obvious that $\mcS$ is an algebra.
    Define \[
        \lambda_\mcS(I_1 \sqcup \dots \sqcup I_k)
        = \sum_{j=1}^k (\sup I_j - \inf I_j).
    \]
    We need to show that this is countably additive, in order that
    \nameref{thm:caratheodory} applies.
    We will proceed via \cref{thm:additivity}.
    \begin{itemize}
        \item Finite additivity is obvious.
        \item Let $A_n, A \in \mcS$ with $A_n \upto A$.
        Then it should be sort of obvious that
        $\lambda_\mcS(A_n) \upto \lambda_\mcS(A)$. \TODO[Yes?]
    \end{itemize}
    By Carathéodory's extension theorem, there exists a unique
    probability measure $\lambda$ on $\F = \sigma(\mcS)$ that extends
    $\lambda_\mcS$.
\end{proof}
