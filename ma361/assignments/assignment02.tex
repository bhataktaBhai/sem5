\documentclass[12pt]{article}
\input{../preamble}
\setenumerate{label=(\arabic*)}

\title{Homework 2}
\author{Naman Mishra (22223)}
\date{20 August, 2024}

\begin{document}
\maketitle

% Problem 1
\begin{problem*} \leavevmode
    \begin{enumerate}
        \item Let $\Omega$ be a set and $A \subseteq \Omega$.
        Define a function $\1A\colon \Omega \to \R$ as follows. \[
            \1A(\omega) = \begin{cases}
                1 & \text{if } \omega \in A \\
                0 & \text{if } \omega \notin A.
            \end{cases}
        \] What is the smallest $\sigma$-algebra on $\Omega$ with respect to
        which $\1A$ becomes a random variable?
        \item Assume that $A \in \F$.
        Give an explicit description of the push-forward measure
        ${\P} \circ (\1A)^{-1}$ on \R.
        % \item Define T : Ω → Rn by T(ω) = (1A1(ω),...,1An(ω)) where A1,...,An are given subsets of Ω. What is the smallest σ-algebra on Ω such that T becomes a random variable?
        \item Define $T\colon \Omega \to \R^n$ by
        $T(\omega) = (\1{A_1}(\omega), \dots, \1{A_n}(\omega))$ where
        $A_1, \dots, A_n$ are given subsets of $\Omega$.
        What is the smallest $\sigma$-algebra on $\Omega$ such that $T$
        becomes a random variable?
        % \item AssumeA1,A2,···Ak ∈F. Describethepush-forwardmeasureP◦T−1 onRn.
        \item Assume $A_1, A_2, \dots, A_k \in \F$.
        Describe the push-forward measure ${\P} \circ T^{-1}$ on $\R^n$.
    \end{enumerate}
\end{problem*}
\begin{solution} \leavevmode
    \begin{enumerate}
        \item We need $\1A^{-1}(B) \in \F$ for $B \in \mcB(\R)$. \[
                (\1A)^{-1}(B) = \begin{cases}
                    \O & \text{if } 0, 1 \notin B, \\
                    A & \text{if } 1 \in B, 0 \notin B, \\
                    A^c & \text{if } 0 \in B, 1 \notin B, \\
                    \Omega & \text{if } 0, 1 \in B.
                \end{cases}
            \]
            Thus $\F$ must contain $\O, A, A^c, \Omega$.
            $\F = \set{\O, A, A^c, \Omega}$ is itself a $\sigma$-algebra,
            hence the smallest one that works.
            This is in fact the $\sigma$-algebra generated by $\set A$.
        \item Let $B \in \mcB(\R)$. Then \[
            ({\P} \circ (\1A)^{-1})(B) = \begin{cases}
                    0 & \text{if } 0, 1 \notin B, \\
                    \P(A) & \text{if } 1 \in B, 0 \notin B, \\
                    \P(A^c) & \text{if } 0 \in B, 1 \notin B, \\
                    1 & \text{if } 0, 1 \in B.
                \end{cases} \qedhere
        \]
        \item Since $A_i$ is the inverse image of \[
            \underbrace{\R \times \dots \times \R \times}_{i-1}
                \set 1
            \underbrace{\times \R \times \dots \times \R}_{k-i-1},
        \] we have that $\F$ contains all $A_i$.
        Since $\F$ is a $\sigma$-algebra, it must contain all countable
        unions and intersections of the $A_i$.
        Let $\F = \sigma\set{A_i}$.

        $T(\omega) \in \set{0, 1}^k$ for all $\omega$.
        Let $A^{(1)} = A$ and $A^{(0)} = A^c$ for any event $A$.
        Then \[
            T^{-1}(B) = \bigcup_{v \in B \cap 2^k}
                \bigcap_{i=1}^n A_i^{(v_i)} \in \F
        \] Thus the preimage of any Borel set is in $\F$.
        \item For any $B \subseteq \R^n$, \[
            T^{-1}(B) = \bigcup_{v \in B \cap 2^k}
                \bigcap_{i=1}^k A^{(v_i)}.
        \] This is a disjoint union of sets in $\F$, so \[
            ({\P} \circ T^{-1})(B) = \sum_{v \in B \cap 2^k}
                \P\ab(\bigcap_{i=1}^k A^{(v_i)}).
        \]
    \end{enumerate}
\end{solution}

% Problem 2
\begin{problem*}
    Recall the L\'evy metric $d$ defined in class.
    Show the following.
    \begin{enumerate}
        \item Let $a_n$ be a sequence of real numbers converging to $a$.
        For any $x \in \R$, $\delta_x$ is the measure defined as follows:
        for $A \subseteq \R$, \[
            \delta_x(A) = \begin{cases}
                1 & \text{if } x \in A, \\
                0 & \text{if } x \notin A.
            \end{cases}
        \] Using the definition of the metric show that \[
            d(\delta_{a_n}, \delta_a) \to 0 \text{ as } n \to \infty.
        \]
        \item Consider the sequence of measures
        $\mu_n \coloneq \frac1n \sum_{i=1}^n \delta_{i/n}$
        and $\mu$ is the uniform measure on $[0, 1]$.
        Using the definition show that
        \[
            d(\mu_n, \mu) \to 0 \text{ as } n \to \infty.
        \]
    \end{enumerate}
\end{problem*}
\begin{solution} \leavevmode
    \begin{enumerate}
        \item The CDF of $\delta_x$ is $F_x(\omega) = [\omega \ge x]$.
        If $\abs{x - y} = \eps$, then \[
            F_x(\omega + \eps) = [\omega + \eps \ge x]
            = [\omega \ge x - \eps]
            \ge [\omega \ge y]
            = F_y(\omega)
        \] since $\omega \ge y \implies \omega \ge x - \abs{x - y}$.
        Thus $d(\delta_x, \delta_y) \le \abs{x - y}$.
        As $a_n \to a$, $d(\delta_{a_n}, \delta_a) \to 0$.
        \item The CDF of $\mu$ is $F(x) = x$ for $x \in [0, 1]$.
        The CDF of $\mu_n$ is \[
            F_n(x) = \frac{\floor{nx}}n \quad \text{for } x \in [0, 1].
        \] ($\floor{nx}$ counts the number of points $i/n \le x$, and
        each of those has weight $1/n$.)
        We claim that $d(\mu_n, \mu) \le 1/n$.

        Let $x \in [0, 1]$. Then \begin{align*}
            F\ab(x + \frac1n) + \frac1n &= x + \frac{2}{n} \\
            &= \frac{nx + 2}{n} \\
            &> \frac{\floor{nx}}n = F_n(x).
            \shortintertext{and}
            F_n\ab(x + \frac1n) + \frac1n &= \frac{\floor{n(x + 1/n)} + 1}n \\
            &= \frac{\floor{nx} + 2}n \\
            &> \frac{nx}{n} \\
            &= x = F(x).
        \end{align*}
        Thus \begin{multline*}
            \qquad\frac1n \in \set{\eps > 0 : F_n(x + \eps) + \eps \ge F(x) \text{ and} \\
            F(x + \eps) + \eps \ge F_n(x) \text{ for all } x \in [0, 1]}\qquad
        \end{multline*} and so $d(\mu_n, \mu)$, which is the infimum of all
        such $\eps$, is at most $1/n$.
        It follows that $\lim\limits_{n \to \infty} d(\mu_n, \mu) = 0$
        by the squeeze theorem. \qedhere
    \end{enumerate}
\end{solution}

% Problem 3
\begin{problem*}
    For $k \ge 0$, define the functions $r_k\colon [0, 1) \to \R$ by
    writing $[0, 1) = \bigsqcup\limits_{0 \le j < 2^k} I_j^{(k)}$ where
    $I_j^{(k)}$ is the dyadic interval
    $[j2^{-k}, (j + 1)2^{-k})$ and setting \[
        r_k(x) = \begin{cases}
            -1 & \text{if } x \in I_j^{(k)} \text{ for odd } j, \\
            1 & \text{if } x \in I_j^{(k)} \text{ for even } j.
        \end{cases}
    \]
    Fix $n \ge 1$ and define $T_n\colon [0, 1) \to \set{-1, 1}^n$ by
    $T_n(x) = (r_0(x), \dots, r_{n-1}(x))$.
    Find the push-forward of the Lebesgue measure on $[0, 1)$ under $T_n$.
\end{problem*}
\begin{solution}
    \begin{figure}[h]
        \centering
        \begin{tikzpicture}[scale=.7]
            \foreach \j in {0} {
                \draw[red,thick] (16*\j, 4) --+ (16, 0);
            }
            % \foreach \j in {1,...,0} {
            %     \draw[blue,thick] (16*\j, 4) --+ (16, 0);
            % }
            \foreach \j in {0} {
                \draw[red,thick] (8*\j, 3) --+ (8, 0);
            }
            \foreach \j in {1} {
                \draw[blue,thick] (8*\j, 3) --+ (8, 0);
            }
            \foreach \j in {0,2} {
                \draw[red,thick] (4*\j, 2) --+ (4, 0);
            }
            \foreach \j in {1,3} {
                \draw[blue,thick] (4*\j, 2) --+ (4, 0);
            }
            \foreach \j in {0,2,...,7} {
                \draw[red,thick] (2*\j, 1) --+ (2, 0);
            }
            \foreach \j in {1,3,...,7} {
                \draw[blue,thick] (2*\j, 1) --+ (2, 0);
            }
            \foreach \j in {0,2,...,15} {
                \draw[red,thick] (\j, 0) --+ (1, 0);
            }
            \foreach \j in {1,3,...,15} {
                \draw[blue,thick] (\j, 0) --+ (1, 0);
            }
        \end{tikzpicture}
    \end{figure}
\end{solution}

\begin{problem*}
    % If T : R → R, show that T is Borel measurable if it is (1) continuous or (2) increasing.
    If $T\colon \R \to \R$, show that $T$ is Borel measurable if it is
    (1) continuous or (2) increasing.
\end{problem*}
\begin{solution} \leavevmode
    \begin{enumerate}
        \item The preimage of any open set is open.
        \item For any $x \in \R$, $T^{-1}(-\infty, x]$ is the set of all
        $y \in \R$ such that $T(y) \le x$.
        Since $T$ is increasing, $T(y) \le x \implies T(y') \le x$ for all
        $y' \le y$.
        Thus $T^{-1}(-\infty, x] = (-\infty, y_0]$ or $(-\infty, y_0)$
        for some $y_0 \in \R$. \qedhere
    \end{enumerate}
\end{solution}

\begin{problem*}[Change of variable for densities]
% (1) Let μ be a p.m. on R with density f by which we mean that its CDF Fμ (x) = R x f (t)dt (you may assume that f is continuous,
% non-negative and the Riemann integral R f = 1). Then, find the (density of the) push R
% forward measure of μ under (a) T(x) = x + a (b) T(x) = bx (c) T is any increasing and differentiable function.
    Let $\mu$ be a probability measure on $\R$ with density $f$,
    by which we mean that its CDF $F_\mu(x) = \int_{-\infty}^x f(t) \dd t$
    (you may assume that $f$ is continuous, non-negative and the Riemann
    integral $\int_\R f = 1$).
    Then, find the (density of the) push-forward measure of $\mu$ under
    \begin{enumerate}
        \item $T(x) = x + a$,
        \item $T(x) = bx$,
        \item $T$ is any increasing and differentiable function.
    \end{enumerate}
\end{problem*}
\begin{solution} \leavevmode
    \begin{enumerate}
        \item The CDF of the push-forward measure is \begin{align*}
            F_{\mu T^{-1}}(x) &= \mu(T^{-1}(-\infty, x]) \\
                &= \mu(-\infty, x - a] \\
                &= F_\mu(x - a) \\
                &= \int_{-\infty}^{x - a} f(t) \dd t \\
                &= \int_{-\infty}^x f(t - a) \dd t.
        \end{align*} Thus the density of the push-forward measure is
        $x \mapsto f(x - a)$.
        \item \begin{align*}
            F_{\mu T^{-1}}(x) &= \mu(T^{-1}(-\infty, x]) \\
                &= \mu(-\infty, x/b] \\
                &= F_\mu(x/b) \\
                &= \int_{-\infty}^{x/b} f(t) \dd t \\
                &= \int_{-\infty}^x \frac1b f(t/b) \dd t.
        \end{align*}
        The density is $x \mapsto \frac1b f(x/b)$.
        \item Let $U(y) = \sup\sset{x}{T(x) \le y}$.
        Since $T$ is continuous and increasing, we have that if $U(y)$ is
        finite, then $T(U(y)) = x$.
        We note that \[
            T(x) \le y \iff x \le U(y),
        \] so that \[
            \mu T^{-1} (-\infty, y] = \mu (-\infty, U(y)].
        \]
        If $T$ is strictly increasing, then $U(y)$ is continuous and the
        true inverse of $T$.
        If further $T' > 0$, then $U$ is differentiable, and \begin{align*}
            \mu T^{-1} (-\infty, y] &= \mu (-\infty, U(y)] \\
                &= F_\mu(U(y)) \\
                &= \int_{-\infty}^{U(y)} f(t) \dd t \\
                &= \int_{-\infty}^y f(U(y)) U'(y) \dd y.
        \end{align*}
        The density of the push-forward measure is
        $f \circ T^{-1} \cdot (T^{-1})'$. \[
            f_{\mu T^{-1}}(y) = f(T^{-1}(y)) \cdot \frac1{T'(T^{-1}(y))}
                \qedhere
        \]
    \end{enumerate}
\end{solution}

\end{document}
